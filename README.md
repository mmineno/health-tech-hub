# 複式簿記 CSV 摘要変換ツール

このツールは、複式簿記の CSV データ（例：弥生会計からのエクスポートデータ）の摘要欄を汎用的な表現に変換するためのものです。

## 機能

- インボイス番号などの詳細情報を削除
- 勘定科目に基づいて摘要を標準化
- 特定のキーワードに基づいて摘要を分類
- 取引先情報を活用した詳細な分類

## 対応している変換ルール

### 勘定科目別ルール

| 勘定科目   | 変換ルール                                                                                                                                                                                             |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 外注費     | 「質問・アンケート」を含む場合は「外注アンケート調査費」に変換<br>さらに、取引先がクラウドワークスの場合は「外注アンケート調査費 クラウドワークス」に変換                                              |
| 新聞図書費 | すべて「書籍購入費」に変換                                                                                                                                                                             |
| 消耗品費   | そのまま「消耗品費」として保持                                                                                                                                                                         |
| 会議費     | 「カフェ」「食事」「飲食」を含む場合は「会議用飲食費」に変換                                                                                                                                           |
| 接待交際費 | 「飲食」「食事」「カラオケ」などを含む場合は「接待飲食費」に変換<br>「スイーツ」「ショコラ」「贈答」「ギフト」などを含む場合は「接待贈答費」に変換<br>その他の接待交際費は全て「接待飲食費」として変換 |
| 旅費交通費 | 「タクシー」を含む場合は「タクシー代」に変換<br>その他のすべての旅費交通費は「電車代・特急券代」に変換                                                                                                 |

### 特定キーワード別ルール

| キーワード                                                                        | 変換結果                     |
| --------------------------------------------------------------------------------- | ---------------------------- |
| Claude, ChatGPT, GitHub, OpenAI, AI                                               | 「AI 使用料」に変換          |
| home wifi, wifi, インターネット                                                   | 「通信費」に変換             |
| JR 東車券, 新幹線, 特急, JR 乗車券, 乗車券類, JR, 乗車券, 電車, SUICA, PASMO など | 「電車代・特急券代」に変換   |
| タクシー                                                                          | 「タクシー代」に変換         |
| 証紙切手引受, 切手, 郵便                                                          | 「郵便料金」に変換           |
| Creative C                                                                        | 「ソフトウェア使用料」に変換 |

### 取引先別ルール

| 取引先           | 変換ルール                                                                        |
| ---------------- | --------------------------------------------------------------------------------- |
| ヨドバシカメラ   | 勘定科目に関わらず、すべて「書籍代」に変換                                        |
| クラウドワークス | 「質問・アンケート」を含む外注費は「外注アンケート調査費 クラウドワークス」に変換 |

## 使用方法

```bash
# 基本的な使用方法
python generalize_descriptions.py 入力ファイル.csv

# 出力ファイル名を指定する場合
python generalize_descriptions.py 入力ファイル.csv -o 出力ファイル.csv
```

## 注意事項

- CSV ファイルは、弥生会計のエクスポート形式を想定しています
- 入力 CSV ファイルは UTF-8 エンコーディングである必要があります
- 出力ファイル名が指定されない場合、「元のファイル名*generalized*タイムスタンプ.csv」という名前で保存されます
- 取引先情報を利用した処理を行うために、CSV ファイルには取引先名の列（25 列目と 26 列目）が必要です

## 実行例

```bash
# work-env仮想環境をアクティベートして実行
source work-env/bin/activate && python3 generalize_descriptions.py yayoi_output_quoted.csv

# 処理が完了すると以下のようなメッセージが表示されます
# 処理が完了しました: yayoi_output_quoted_generalized_20240315093045.csv
```
